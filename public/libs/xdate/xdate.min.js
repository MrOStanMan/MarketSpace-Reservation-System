var XDate=function(Date,Math,Array,undefined){function XDate(){return init(this instanceof XDate?this:new XDate,arguments)}function init(xdate,args){var utcMode,len=args.length;if(isBoolean(args[len-1])&&(utcMode=args[--len],args=slice(args,0,len)),len)if(1==len){var arg=args[0];arg instanceof Date||isNumber(arg)?xdate[0]=new Date(+arg):arg instanceof XDate?xdate[0]=_clone(arg):isString(arg)&&(xdate[0]=new Date(0),xdate=parse(arg,utcMode||!1,xdate))}else xdate[0]=new Date(UTC.apply(Date,args)),utcMode||(xdate[0]=coerceToLocal(xdate[0]));else xdate[0]=new Date;return isBoolean(utcMode)&&setUTCMode(xdate,utcMode),xdate}function getUTCMode(xdate){return xdate[0].toString===toUTCString}function setUTCMode(xdate,utcMode,doCoercion){return utcMode?getUTCMode(xdate)||(doCoercion&&(xdate[0]=coerceToUTC(xdate[0])),xdate[0].toString=toUTCString):getUTCMode(xdate)&&(doCoercion?xdate[0]=coerceToLocal(xdate[0]):xdate[0]=new Date(+xdate[0])),xdate}function _set(xdate,fieldIndex,value,args,useUTC){var expectedMonth,getField=curry(_getField,xdate[0],useUTC),setField=curry(_setField,xdate[0],useUTC),preventOverflow=!1;2==args.length&&isBoolean(args[1])&&(preventOverflow=args[1],args=[value]),expectedMonth=fieldIndex==MONTH?(value%12+12)%12:getField(MONTH),setField(fieldIndex,args),preventOverflow&&getField(MONTH)!=expectedMonth&&(setField(MONTH,[getField(MONTH)-1]),setField(DATE,[getDaysInMonth(getField(FULLYEAR),getField(MONTH))]))}function _add(xdate,fieldIndex,delta,preventOverflow){delta=Number(delta);var intDelta=Math.floor(delta);xdate["set"+methodSubjects[fieldIndex]](xdate["get"+methodSubjects[fieldIndex]]()+intDelta,preventOverflow||!1),intDelta!=delta&&MILLISECONDS>fieldIndex&&_add(xdate,fieldIndex+1,(delta-intDelta)*unitsWithin[fieldIndex],preventOverflow)}function _diff(xdate1,xdate2,fieldIndex){xdate1=xdate1.clone().setUTCMode(!0,!0),xdate2=XDate(xdate2).setUTCMode(!0,!0);var v=0;if(fieldIndex==FULLYEAR||fieldIndex==MONTH){for(var i=MILLISECONDS;i>=fieldIndex;i--)v/=unitsWithin[i],v+=_getField(xdate2,!1,i)-_getField(xdate1,!1,i);fieldIndex==MONTH&&(v+=12*(xdate2.getFullYear()-xdate1.getFullYear()))}else if(fieldIndex==DATE){var clear1=xdate1.toDate().setUTCHours(0,0,0,0),clear2=xdate2.toDate().setUTCHours(0,0,0,0);v=Math.round((clear2-clear1)/DAY_MS)+(xdate2-clear2-(xdate1-clear1))/DAY_MS}else v=(xdate2-xdate1)/[36e5,6e4,1e3,1][fieldIndex-3];return v}function _getWeek(getField){return getWeek(getField(FULLYEAR),getField(MONTH),getField(DATE))}function getWeek(year,month,date){var d=new Date(UTC(year,month,date)),week1=getWeek1(getWeekYear(year,month,date));return Math.floor(Math.round((d-week1)/DAY_MS)/7)+1}function getWeekYear(year,month,date){var d=new Date(UTC(year,month,date));return d<getWeek1(year)?year-1:d>=getWeek1(year+1)?year+1:year}function getWeek1(year){var d=new Date(UTC(year,0,4));return d.setUTCDate(d.getUTCDate()-(d.getUTCDay()+6)%7),d}function _setWeek(xdate,n,year,useUTC){var getField=curry(_getField,xdate,useUTC),setField=curry(_setField,xdate,useUTC);year===undefined&&(year=getWeekYear(getField(FULLYEAR),getField(MONTH),getField(DATE)));var week1=getWeek1(year);useUTC||(week1=coerceToLocal(week1)),xdate.setTime(+week1),setField(DATE,[getField(DATE)+7*(n-1)])}function parse(str,utcMode,xdate){for(var res,parsers=XDate.parsers,i=0;i<parsers.length;i++)if(res=parsers[i](str,utcMode,xdate))return res;return xdate[0]=new Date(str),xdate}function parseISO(str,utcMode,xdate){var m=str.match(/^(\d{4})(-(\d{2})(-(\d{2})([T ](\d{2}):(\d{2})(:(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/);if(m){var d=new Date(UTC(m[1],m[3]?m[3]-1:0,m[5]||1,m[7]||0,m[8]||0,m[10]||0,m[12]?1e3*Number("0."+m[12]):0));return m[13]?m[14]&&d.setUTCMinutes(d.getUTCMinutes()+("-"==m[15]?1:-1)*(60*Number(m[16])+(m[18]?Number(m[18]):0))):utcMode||(d=coerceToLocal(d)),xdate.setTime(+d)}}function format(xdate,formatString,settings,uniqueness,useUTC){function getSetting(name){return settings[name]||defaultLocaleSettings[name]}function getFieldAndTrace(fieldIndex){if(uniqueness)for(var i=(fieldIndex==DAY?DATE:fieldIndex)-1;i>=0;i--)uniqueness.push(getField(i));return getField(fieldIndex)}var locales=XDate.locales,defaultLocaleSettings=locales[XDate.defaultLocale]||{},getField=curry(_getField,xdate,useUTC);return settings=(isString(settings)?locales[settings]:settings)||{},_format(xdate,formatString,getFieldAndTrace,getSetting,useUTC)}function _format(xdate,formatString,getField,getSetting,useUTC){for(var m,subout,out="";m=formatString.match(formatStringRE);)out+=formatString.substr(0,m.index),m[1]?out+=processTokenString(xdate,m[1],getField,getSetting,useUTC):m[3]?(subout=_format(xdate,m[4],getField,getSetting,useUTC),parseInt(subout.replace(/\D/g,""),10)&&(out+=subout)):out+=m[7]||"'",formatString=formatString.substr(m.index+m[0].length);return out+formatString}function processTokenString(xdate,tokenString,getField,getSetting,useUTC){for(var replacement,end=tokenString.length,out="";end>0;)replacement=getTokenReplacement(xdate,tokenString.substr(0,end),getField,getSetting,useUTC),replacement!==undefined?(out+=replacement,tokenString=tokenString.substr(end),end=tokenString.length):end--;return out+tokenString}function getTokenReplacement(xdate,token,getField,getSetting,useUTC){var formatter=XDate.formatters[token];if(isString(formatter))return _format(xdate,formatter,getField,getSetting,useUTC);if(isFunction(formatter))return formatter(xdate,useUTC||!1,getSetting);switch(token){case"fff":return zeroPad(getField(MILLISECONDS),3);case"s":return getField(SECONDS);case"ss":return zeroPad(getField(SECONDS));case"m":return getField(MINUTES);case"mm":return zeroPad(getField(MINUTES));case"h":return getField(HOURS)%12||12;case"hh":return zeroPad(getField(HOURS)%12||12);case"H":return getField(HOURS);case"HH":return zeroPad(getField(HOURS));case"d":return getField(DATE);case"dd":return zeroPad(getField(DATE));case"ddd":return getSetting("dayNamesShort")[getField(DAY)]||"";case"dddd":return getSetting("dayNames")[getField(DAY)]||"";case"M":return getField(MONTH)+1;case"MM":return zeroPad(getField(MONTH)+1);case"MMM":return getSetting("monthNamesShort")[getField(MONTH)]||"";case"MMMM":return getSetting("monthNames")[getField(MONTH)]||"";case"yy":return(getField(FULLYEAR)+"").substring(2);case"yyyy":return getField(FULLYEAR);case"t":return _getDesignator(getField,getSetting).substr(0,1).toLowerCase();case"tt":return _getDesignator(getField,getSetting).toLowerCase();case"T":return _getDesignator(getField,getSetting).substr(0,1);case"TT":return _getDesignator(getField,getSetting);case"z":case"zz":case"zzz":return useUTC?"Z":_getTZString(xdate,token);case"w":return _getWeek(getField);case"ww":return zeroPad(_getWeek(getField));case"S":var d=getField(DATE);return d>10&&20>d?"th":["st","nd","rd"][d%10-1]||"th"}}function _getTZString(xdate,token){var tzo=xdate.getTimezoneOffset(),sign=0>tzo?"+":"-",hours=Math.floor(Math.abs(tzo)/60),minutes=Math.abs(tzo)%60,out=hours;return"zz"==token?out=zeroPad(hours):"zzz"==token&&(out=zeroPad(hours)+":"+zeroPad(minutes)),sign+out}function _getDesignator(getField,getSetting){return getSetting(getField(HOURS)<12?"amDesignator":"pmDesignator")}function valid(xdate){return!isNaN(+xdate[0])}function _clone(xdate){var d=new Date(+xdate[0]);return getUTCMode(xdate)&&(d.toString=toUTCString),d}function _getField(d,useUTC,fieldIndex){return d["get"+(useUTC?"UTC":"")+methodSubjects[fieldIndex]]()}function _setField(d,useUTC,fieldIndex,args){d["set"+(useUTC?"UTC":"")+methodSubjects[fieldIndex]].apply(d,args)}function coerceToUTC(date){return new Date(UTC(date.getFullYear(),date.getMonth(),date.getDate(),date.getHours(),date.getMinutes(),date.getSeconds(),date.getMilliseconds()))}function coerceToLocal(date){return new Date(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),date.getUTCHours(),date.getUTCMinutes(),date.getUTCSeconds(),date.getUTCMilliseconds())}function getDaysInMonth(year,month){return 32-new Date(UTC(year,month,32)).getUTCDate()}function methodize(f){return function(){return f.apply(undefined,[this].concat(slice(arguments)))}}function curry(f){var firstArgs=slice(arguments,1);return function(){return f.apply(undefined,firstArgs.concat(slice(arguments)))}}function slice(a,start,end){return Array.prototype.slice.call(a,start||0,end===undefined?a.length:end)}function each(a,f){for(var i=0;i<a.length;i++)f(a[i],i)}function isString(arg){return"string"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isBoolean(arg){return"boolean"==typeof arg}function isFunction(arg){return"function"==typeof arg}function zeroPad(n,len){for(len=len||2,n+="";n.length<len;)n="0"+n;return n}var FULLYEAR=0,MONTH=1,DATE=2,HOURS=3,MINUTES=4,SECONDS=5,MILLISECONDS=6,DAY=7,YEAR=8,DAY_MS=864e5,ISO_FORMAT_STRING="yyyy-MM-dd'T'HH:mm:ss(.fff)",ISO_FORMAT_STRING_TZ=ISO_FORMAT_STRING+"zzz",methodSubjects=["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds","Day","Year"],subjectPlurals=["Years","Months","Days"],unitsWithin=[12,31,24,60,60,1e3,1],formatStringRE=new RegExp("(([a-zA-Z])\\2*)|(\\((('.*?'|\\(.*?\\)|.)*?)\\))|('(.*?)')"),UTC=Date.UTC,toUTCString=Date.prototype.toUTCString,proto=XDate.prototype;return proto.length=1,proto.splice=Array.prototype.splice,proto.getUTCMode=methodize(getUTCMode),proto.setUTCMode=methodize(setUTCMode),proto.getTimezoneOffset=function(){return getUTCMode(this)?0:this[0].getTimezoneOffset()},each(methodSubjects,function(subject,fieldIndex){proto["get"+subject]=function(){return _getField(this[0],getUTCMode(this),fieldIndex)},fieldIndex!=YEAR&&(proto["getUTC"+subject]=function(){return _getField(this[0],!0,fieldIndex)}),fieldIndex!=DAY&&(proto["set"+subject]=function(value){return _set(this,fieldIndex,value,arguments,getUTCMode(this)),this},fieldIndex!=YEAR&&(proto["setUTC"+subject]=function(value){return _set(this,fieldIndex,value,arguments,!0),this},proto["add"+(subjectPlurals[fieldIndex]||subject)]=function(delta,preventOverflow){return _add(this,fieldIndex,delta,preventOverflow),this},proto["diff"+(subjectPlurals[fieldIndex]||subject)]=function(otherDate){return _diff(this,otherDate,fieldIndex)}))}),proto.getWeek=function(){return _getWeek(curry(_getField,this,!1))},proto.getUTCWeek=function(){return _getWeek(curry(_getField,this,!0))},proto.setWeek=function(n,year){return _setWeek(this,n,year,!1),this},proto.setUTCWeek=function(n,year){return _setWeek(this,n,year,!0),this},proto.addWeeks=function(delta){return this.addDays(7*Number(delta))},proto.diffWeeks=function(otherDate){return _diff(this,otherDate,DATE)/7},XDate.parsers=[parseISO],XDate.parse=function(str){return+XDate(""+str)},proto.toString=function(formatString,settings,uniqueness){return formatString!==undefined&&valid(this)?format(this,formatString,settings,uniqueness,getUTCMode(this)):this[0].toString()},proto.toUTCString=proto.toGMTString=function(formatString,settings,uniqueness){return formatString!==undefined&&valid(this)?format(this,formatString,settings,uniqueness,!0):this[0].toUTCString()},proto.toISOString=function(){return this.toUTCString(ISO_FORMAT_STRING_TZ)},XDate.defaultLocale="",XDate.locales={"":{monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],amDesignator:"AM",pmDesignator:"PM"}},XDate.formatters={i:ISO_FORMAT_STRING,u:ISO_FORMAT_STRING_TZ},each(["getTime","valueOf","toDateString","toTimeString","toLocaleString","toLocaleDateString","toLocaleTimeString","toJSON"],function(methodName){proto[methodName]=function(){return this[0][methodName]()}}),proto.setTime=function(t){return this[0].setTime(t),this},proto.valid=methodize(valid),proto.clone=function(){return new XDate(this)},proto.clearTime=function(){return this.setHours(0,0,0,0)},proto.toDate=function(){return new Date(+this[0])},XDate.now=function(){return+new Date},XDate.today=function(){return(new XDate).clearTime()},XDate.UTC=UTC,XDate.getDaysInMonth=getDaysInMonth,"undefined"!=typeof module&&module.exports&&(module.exports=XDate),"function"==typeof define&&define.amd&&define([],function(){return XDate}),XDate}(Date,Math,Array);